\ProvidesPackage{musicography}[2021/03/07 musicography]

\DeclareLanguageMapping{english}{english-musicography}
\DeclareLanguageMapping{greek}{greek-musicography}

\DeclareFieldFormat[musicography]{title}{\textit{#1}}

% \newbibmacro*{mainartist}{%
%   \iffieldundef{conductor}{
%     \iffieldundef{director}{
%       \iffieldundef{artist}{
%         \iffieldundef{soloist}{}{
%           \printnames{soloist}}}{
%         \printnames{artist}}}{
%       \printnames{director}}}{
%     \printnames{conductor}}
% }

\newbibmacro*{mainartist}{%
  \printnames{artist}%
}

\newbibmacro*{maindate}{%
  \iffieldundef{recordingyear}%
  {%
    \printfield{releaseyear}%
  }%
  {%
    \printfield{recordingyear}%
  }%
}

\newbibmacro*{artisandensemble}%
{%
  \usebibmacro{mainartist}%
  \iffieldundef{ensemble}{}%
  {
    \bibstring{with}
    \printfield{ensemble}%
  }%
}

\DeclareBibliographyDriver{disc}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{artisandensemble}%
  \newunit\newblock
  \printfield{title}
  \newunit\newblock
  \printfield{label}
  \newunit\newblock
  \usebibmacro{maindate}%
  \newunit\newblock
  \usebibmacro{finentry}%
}

\DeclareLabeldate{%
  \field{recordingyear}
  \field{releaseyear}
  \literal{nodate}
}

\DeclareLabelname{%
  \field{conductor}
  \field{ensemble}
  \field{artist}
  \field{director}
}